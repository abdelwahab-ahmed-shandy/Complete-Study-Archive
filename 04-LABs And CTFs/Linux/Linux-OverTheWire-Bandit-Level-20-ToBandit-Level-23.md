<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>OverTheWire : Bandit Level 20 ToBandit Level 23</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">OverTheWire : Bandit Level 20 ToBandit Level 23</h1>
</header>
<section data-field="subtitle" class="p-summary">
Today we will complete the old report boxes to continue playing : Bandit Level 0 ToBandit Level 10
</section>
<section data-field="body" class="e-content">
<section name="663c" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c4d6" id="c4d6" class="graf graf--h3 graf--leading graf--title">OverTheWire : Bandit Level 20 ToBandit Level 23</h3><p name="53bc" id="53bc" class="graf graf--p graf-after--h3">Today we will complete the old report boxes to continue playing : <a href="https://medium.com/@abdelwahabshandy/overthewire-bandit-level-0-tobandit-level-10-628935ceaee3" data-href="https://medium.com/@abdelwahabshandy/overthewire-bandit-level-0-tobandit-level-10-628935ceaee3" class="markup--anchor markup--p-anchor" target="_blank">Bandit Level 0 ToBandit Level 10</a></p><p name="e999" id="e999" class="graf graf--p graf-after--p">Today we will complete the old report boxes to continue playing : <a href="https://medium.com/@abdelwahabshandy/overthewire-bandit-level-10-tobandit-level-20-2c2255ba16c1" data-href="https://medium.com/@abdelwahabshandy/overthewire-bandit-level-10-tobandit-level-20-2c2255ba16c1" class="markup--anchor markup--p-anchor" target="_blank">Bandit Level 10 ToBandit Level 20</a></p><figure name="a167" id="a167" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*24EfPKLpa03ESwYZCQPyoQ.png" data-width="735" data-height="179" src="https://cdn-images-1.medium.com/max/800/1*24EfPKLpa03ESwYZCQPyoQ.png"><figcaption class="imageCaption">OverTheWire : Bandit Level 20 ToBandit Level 23 …..</figcaption></figure><h3 name="36b7" id="36b7" class="graf graf--h3 graf-after--figure">Bandit Level 20 → Level 21</h3><p name="beb3" id="beb3" class="graf graf--p graf-after--h3">There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).</p><p name="0c17" id="0c17" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">NOTE:</strong> Try connecting to your own network daemon to see if it works as you think</p><p name="3753" id="3753" class="graf graf--p graf-after--p">Commands you may need to solve this level : “ ssh, nc, cat, bash, screen, tmux, Unix ‘job control’ (bg, fg, jobs, &amp;, CTRL-Z, …) “</p><p name="0d8e" id="0d8e" class="graf graf--p graf-after--p">To sign up : ssh <a href="mailto:bandit17@bandit.labs.overthewire.org" data-href="mailto:bandit17@bandit.labs.overthewire.org" class="markup--anchor markup--p-anchor" rel="noopener ugc nofollow" target="_blank">bandit20@bandit.labs.overthewire.org</a> -p 2220<br>Password : VxCazJaVykI6W36BkBU0mJTCM8rR95XT .</p><p name="24a5" id="24a5" class="graf graf--p graf-after--p">The matter here is a little different because we have a binary file that connects to the port specified by the user and reads a line of text. If the text is the same as the last level password, we will get the correct password :</p><figure name="6919" id="6919" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EgR0VpWT2qVvE-MpbQAiFg.png" data-width="748" data-height="349" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*EgR0VpWT2qVvE-MpbQAiFg.png"><figcaption class="imageCaption">Many things must be detailed .</figcaption></figure><p name="1fdb" id="1fdb" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Once he wrote the password for the previous level, it was compared with the text that we specified on port 8080, and since they were identical, we obtained the password for the next level :</em></strong></p><p name="4ec7" id="4ec7" class="graf graf--p graf-after--p">The command <strong class="markup--strong markup--p-strong">echo “VxCazJaVykI6W36BkBU0mJTCM8rR95XT” | netcat -lp 8080 &amp;</strong> is a combination of two commands: echo and netcat.</p><p name="6bff" id="6bff" class="graf graf--p graf-after--p">The echo command simply prints the text string <strong class="markup--strong markup--p-strong">“VxCazJaVykI6W36BkBU0mJTCM8rR95XT”</strong> to the standard output. The pipe (<strong class="markup--strong markup--p-strong">|</strong>) symbol is used to redirect the output of the echo command to the input of the netcat command.</p><p name="332f" id="332f" class="graf graf--p graf-after--p">The <strong class="markup--strong markup--p-strong">netcat</strong> command is a network utility that can be used to establish TCP or UDP connections to other hosts. The <strong class="markup--strong markup--p-strong">-lp</strong> option tells netcat to listen for incoming connections on port <strong class="markup--strong markup--p-strong">8080</strong>. The &amp; symbol at the end of the command tells the shell to execute the command in the background, so that you can continue to use the terminal.</p><p name="bc88" id="bc88" class="graf graf--p graf-after--p">So, the overall effect of the command is to listen for incoming TCP connections on <strong class="markup--strong markup--p-strong">port 8080</strong>, and when a connection is established, to send the text string <strong class="markup--strong markup--p-strong">“VxCazJaVykI6W36BkBU0mJTCM8rR95XT”</strong> to the connected host.</p><p name="9fdb" id="9fdb" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Here is a breakdown of the command:</em></strong></p><p name="d6c5" id="d6c5" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">echo</strong>: Prints the specified text to the standard output.<br><strong class="markup--strong markup--p-strong">“VxCazJaVykI6W36BkBU0mJTCM8rR95XT”</strong>: The text string to be printed by the echo command.<br><strong class="markup--strong markup--p-strong">( | )</strong>: Redirects the output of the echo command to the input of the netcat command.<br><strong class="markup--strong markup--p-strong">netcat</strong> : A network utility for establishing TCP or UDP connections.<br><strong class="markup--strong markup--p-strong">-lp</strong> : Tells netcat to listen for incoming connections on port 8080.<br><strong class="markup--strong markup--p-strong">8080</strong> : The port number to listen on.<br><strong class="markup--strong markup--p-strong">&amp; </strong>: Executes the command in the background.</p><p name="76e2" id="76e2" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">The </em>ps<em class="markup--em markup--p-em"> command can be used to display a variety of information about running processes, including:</em></strong></p><ul class="postList"><li name="1e23" id="1e23" class="graf graf--li graf-after--p">Process ID (PID): A unique identifier for each process.</li><li name="3f34" id="3f34" class="graf graf--li graf-after--li">Parent process ID (PPID): The PID of the process that started the current process.</li><li name="bf9c" id="bf9c" class="graf graf--li graf-after--li">User: The name of the user who owns the process.</li><li name="2f8a" id="2f8a" class="graf graf--li graf-after--li">%CPU: The percentage of CPU time that the process is using.</li><li name="96bc" id="96bc" class="graf graf--li graf-after--li">%MEM: The percentage of physical memory that the process is using.</li><li name="4a6a" id="4a6a" class="graf graf--li graf-after--li">Vssize: The virtual size of the process in bytes.</li><li name="a27b" id="a27b" class="graf graf--li graf-after--li">RSS: The resident set size of the process in bytes.</li><li name="49db" id="49db" class="graf graf--li graf-after--li">Stat: The state of the process (e.g., running, sleeping, stopped).</li><li name="d6e1" id="d6e1" class="graf graf--li graf-after--li">Command: The command line that was used to start the process.</li></ul><p name="5ac5" id="5ac5" class="graf graf--p graf-after--li">The <strong class="markup--strong markup--p-strong">jobs</strong> command is a built-in command in several Unix-like shells, including bash . It is used to display a list of all background jobs that are currently running in the current shell session.</p><p name="3a54" id="3a54" class="graf graf--p graf-after--p">Background jobs are processes that have been started using the <strong class="markup--strong markup--p-strong">&amp; </strong>operator at the end of the command. This operator tells the shell to run the command in the background, which means that the shell will not wait for the command to finish before returning to the prompt.</p><h3 name="9d40" id="9d40" class="graf graf--h3 graf-after--p">Bandit Level 21 → Level 22</h3><p name="4d18" id="4d18" class="graf graf--p graf-after--h3">A program is running automatically at regular intervals from <strong class="markup--strong markup--p-strong">cron</strong>, the time-based job scheduler. Look in <strong class="markup--strong markup--p-strong">/etc/cron.d/</strong> for the configuration and see what command is being executed.</p><p name="ac01" id="ac01" class="graf graf--p graf-after--p">To sign up : ssh <a href="mailto:bandit17@bandit.labs.overthewire.org" data-href="mailto:bandit17@bandit.labs.overthewire.org" class="markup--anchor markup--p-anchor" rel="noopener ugc nofollow" target="_blank">bandit21@bandit.labs.overthewire.org</a> -p 2220<br>Password : NvEJF7oVjkddltPSrdKEFOllh9V1IBcq .</p><figure name="5a36" id="5a36" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ic1JcBYfihiuRG5MwFTzqA.png" data-width="689" data-height="366" src="https://cdn-images-1.medium.com/max/800/1*ic1JcBYfihiuRG5MwFTzqA.png"><figcaption class="imageCaption">You have to use man 5 crontab .</figcaption></figure><p name="a74e" id="a74e" class="graf graf--p graf-after--figure">The <strong class="markup--strong markup--p-strong">crontab</strong> command is a built-in command in Unix-like operating systems that manages cron jobs, which are tasks that are scheduled to run at specific times or intervals. It is a powerful tool for automating tasks, such as backups, system maintenance, and sending notifications.</p><p name="a732" id="a732" class="graf graf--p graf-after--p">When we looked at the file /etc/cron.d<br>They found a number of jobs, when we looked at cronjob_bandit22 because it is our target, we found that there is a shell script that is executed every second.</p><p name="0500" id="0500" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">When we looked at the script, we found that it creates a file called in the directory and then saves the password for the next level in that file : </em><br><strong class="markup--strong markup--p-strong">chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv<br>cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAo</strong></p><p name="1b91" id="1b91" class="graf graf--p graf-after--p">We can view the content of the file, so when we viewed it, we found a text that I think is the password .</p><h3 name="7a3b" id="7a3b" class="graf graf--h3 graf-after--p">Bandit Level 22 → Level 23</h3><p name="4b67" id="4b67" class="graf graf--p graf-after--h3">A program is running automatically at regular intervals from <strong class="markup--strong markup--p-strong">cron</strong>, the time-based job scheduler. Look in <strong class="markup--strong markup--p-strong">/etc/cron.d/</strong> for the configuration and see what command is being executed.</p><p name="8630" id="8630" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">NOTE:</strong> Looking at shell scripts written by other people is a very useful skill. The script for this level is intentionally made easy to read. If you are having problems understanding what it does, try executing it to see the debug information it prints.</p><p name="e191" id="e191" class="graf graf--p graf-after--p">To sign up : ssh <a href="mailto:bandit17@bandit.labs.overthewire.org" data-href="mailto:bandit17@bandit.labs.overthewire.org" class="markup--anchor markup--p-anchor" rel="noopener ugc nofollow" target="_blank">bandit22@bandit.labs.overthewire.org</a> -p 2220<br>Password : WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff .</p><figure name="cdf9" id="cdf9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*-_4aNNxgmcN1495SbT4EBw.png" data-width="679" data-height="367" src="https://cdn-images-1.medium.com/max/800/1*-_4aNNxgmcN1495SbT4EBw.png"></figure><p name="f097" id="f097" class="graf graf--p graf-after--figure">The echo command simply prints the text string <strong class="markup--strong markup--p-strong">“I am user $myname”</strong> to the standard output. <strong class="markup--strong markup--p-strong">The pipe (|) </strong>symbol is used to redirect the output of the echo command to the input of the md5sum command.</p><p name="494e" id="494e" class="graf graf--p graf-after--p">The md5sum command is a cryptographic hash function that generates a unique 128-bit fingerprint for the input data. In this case, the input data is the text string <strong class="markup--strong markup--p-strong">“I am user $myname”</strong>. The md5sum command prints the hash value to the standard output.</p><p name="5cc5" id="5cc5" class="graf graf--p graf-after--p">The cut command is used to cut fields from a line of text. In this case, the -d ‘ ‘ option specifies that the delimiter is a space character, and the -f 1 option specifies that only the first field should be printed. So, the cut command takes the hash value that was printed by the md5sum command and prints only the first field, which is the hash value itself.</p><p name="6ee4" id="6ee4" class="graf graf--p graf-after--p">Therefore, the overall effect of the command is to print the MD5 hash of the text string “I am user $myname”.</p><p name="8623" id="8623" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Here is a breakdown of the command:</em></strong></p><p name="6ba6" id="6ba6" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">echo</strong> : Prints the specified text to the standard output.<br><strong class="markup--strong markup--p-strong">“I am user $myname” </strong>: The text string to be printed by the echo command.<br>( <strong class="markup--strong markup--p-strong">|</strong> ) : Redirects the output of the echo command to the input of the md5sum command.<br><strong class="markup--strong markup--p-strong">md5sum</strong> : A cryptographic hash function that generates a unique 128-bit fingerprint for the input data.<br><strong class="markup--strong markup--p-strong">( | )</strong> : Redirects the output of the md5sum command to the input of the cut command.<br><strong class="markup--strong markup--p-strong">cut</strong> : Cuts fields from a line of text.<br><strong class="markup--strong markup--p-strong">-d ‘ ‘</strong> : Specifies that the delimiter is a space character.<br><strong class="markup--strong markup--p-strong">-f 1 </strong>: Specifies that only the first field should be printed.</p><p name="f7c3" id="f7c3" class="graf graf--p graf-after--p">When I kept track of things, such as the solution of the previous level, I found some things that we needed to follow up on :</p><figure name="73b7" id="73b7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UEddlcTsnpBrE-p25-SBZQ.png" data-width="740" data-height="267" src="https://cdn-images-1.medium.com/max/800/1*UEddlcTsnpBrE-p25-SBZQ.png"><figcaption class="imageCaption">We have to search here .</figcaption></figure><p name="3199" id="3199" class="graf graf--p graf-after--figure">The command <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget</strong></code> is a shell command that copies the contents of the file <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">/etc/bandit_pass/$myname</strong></code> to the file <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">/tmp/$mytarget</strong></code>.</p><ul class="postList"><li name="9299" id="9299" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">cat</strong></code>: The <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">cat</strong></code> command is a standard Unix/Linux command that concatenates files and prints them to the standard output. In this case, the <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">cat</strong></code><strong class="markup--strong markup--li-strong"> </strong>command is being used to read the contents of a file.</li><li name="f1fa" id="f1fa" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">/etc/bandit_pass/$myname</strong></code>: This is the path to the file that the <code class="markup--code markup--li-code">cat</code> command will read. The <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">/etc/bandit_pass</strong></code> directory is a directory that contains password files for users on the system. The <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">$myname</strong></code> variable is a shell variable that contains the current user&#39;s name.</li><li name="16f6" id="16f6" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">&gt;</strong></code>: The <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">&gt;</strong></code> operator is the redirection operator. It is used to redirect the output of a command to a file. In this case, the <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">&gt;</strong></code><strong class="markup--strong markup--li-strong"> </strong>operator is redirecting the output of the <code class="markup--code markup--li-code">cat</code> command to the file <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">/tmp/$mytarget</strong></code>.</li><li name="c506" id="c506" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">/tmp/$mytarget</strong></code>: This is the path to the file that the contents of <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">/etc/bandit_pass/$myname</strong></code> will be copied to. The <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">/tmp</strong></code> directory is a temporary directory that is typically used for storing temporary files. The <code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong">$mytarget</strong></code> variable is a shell variable that contains the name of the target file.</li></ul><figure name="a36c" id="a36c" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*i0mFfWGXaV5T8asv4ioMKg.png" data-width="740" data-height="194" src="https://cdn-images-1.medium.com/max/800/1*i0mFfWGXaV5T8asv4ioMKg.png"><figcaption class="imageCaption">You have to pay attention here .</figcaption></figure><p name="1d1c" id="1d1c" class="graf graf--p graf-after--figure">This command must be modified. I am user $myname ,And then do the cat command to extract the password for the next level. Let’s go, my friend …!</p><h3 name="ad68" id="ad68" class="graf graf--h3 graf-after--p">Bandit Level 23 → Level 24</h3><p name="f0a7" id="f0a7" class="graf graf--p graf-after--h3">To sign up : ssh <a href="mailto:bandit17@bandit.labs.overthewire.org" data-href="mailto:bandit17@bandit.labs.overthewire.org" class="markup--anchor markup--p-anchor" rel="noopener ugc nofollow" target="_blank">bandit23@bandit.labs.overthewire.org</a> -p 2220<br>Password : QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G</p><p name="ee9d" id="ee9d" class="graf graf--p graf-after--p">Next roles may require detailed reports, so see you soon…….!!</p><p name="1051" id="1051" class="graf graf--p graf-after--p">We’ll meet later, my friend……</p><p name="32e8" id="32e8" class="graf graf--p graf-after--p">ِAbdelwahab_Shandy</p><p name="cb87" id="cb87" class="graf graf--p graf-after--p graf--trailing">AS_Cyber</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@abdelwahabshandy" class="p-author h-card">Abdelwahab Shandy 🦅</a> on <a href="https://medium.com/p/77d83472338d"><time class="dt-published" datetime="2023-11-23T00:32:15.814Z">November 23, 2023</time></a>.</p><p><a href="https://medium.com/@abdelwahabshandy/overthewire-bandit-level-20-tobandit-level-23-77d83472338d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on July 8, 2025.</p></footer></article></body></html>