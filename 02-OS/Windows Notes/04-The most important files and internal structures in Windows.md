
## الباب الخامس : بنية Windows الأساسية

> هذا الباب هو جوهر تحليل النظام، التحقيق الجنائي، واكتشاف البرمجيات الخبيثة، ويُعد ضروريًا لأي شخص يدخل مجال **السايبر سيكيورتي** من زاوية Windows.

## 🔐 أولاً: **سجل النظام (Registry)**

#### 📌 ما هو الـ Registry؟

قاعدة بيانات هرمية تحتوي على إعدادات النظام، المستخدمين، التطبيقات، التعريفات... إلخ.
#### 📂 المسارات الأساسية:
|المفتاح الرئيسي|الوظيفة|
|---|---|
|`HKEY_LOCAL_MACHINE (HKLM)`|إعدادات النظام العامة|
|`HKEY_CURRENT_USER (HKCU)`|إعدادات المستخدم الحالي|
|`HKEY_CLASSES_ROOT`|ربط أنواع الملفات|
|`HKEY_USERS`|إعدادات جميع المستخدمين|
|`HKEY_CURRENT_CONFIG`|إعدادات العتاد النشط|
#### 🎯 الاستخدامات الأمنية:
|الحالة|المفتاح المهم|
|---|---|
|برامج الإقلاع التلقائي|`HKLM\Software\Microsoft\Windows\CurrentVersion\Run`|
|تحليل برامج خبيثة|أماكن إنشاء مفاتيح مشبوهة|
|تحليل المستخدمين|`HKLM\SAM` ← يحتوي على كلمات المرور (مشفرة)|
|تحديد البرامج المثبتة|`HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall`|
🔎 **تحذير**: تعديل الـ Registry بشكل خاطئ قد يُعطل النظام. استخدمه بحذر.

🛠️ أدوات مساعدة:

- `regedit` – أداة العرض والتعديل

- `Autoruns` – يعرض مفاتيح الإقلاع التلقائي

- `Regshot` – مقارنة قبل وبعد التعديلات
---
## 📝 ثانيًا: **سجلات الأحداث (Event Logs)**

#### 📌 ما هي Event Logs؟

ملفات تُسجل كل الأحداث على النظام (تسجيل دخول، أخطاء، تنبيهات، تشغيل خدمات...)

📍 يمكن الوصول إليها عبر:

> `eventvwr.msc`

### 📂 أنواع السجلات المهمة:
|السجل|الوظيفة|
|---|---|
|**System**|تسجيل أحداث النظام والخدمات|
|**Application**|تسجيل أحداث البرامج|
|**Security**|محاولات الدخول، الفشل، نجاح تسجيل الدخول|
|**Setup**|أحداث التثبيت|
|**Windows Defender**|اكتشافات الحماية|

🔐 في التحقيق الجنائي (Forensics):

- ابحث عن محاولات تسجيل دخول فاشلة/ناجحة

- التحقق من توقيت تشغيل خدمة مشبوهة

- تحليل أثر اختراق أو Malware


🛠️ أدوات متقدمة:

- `Log Parser` – لتحليل السجلات كملفات قواعد بيانات

- `Windows Event Forwarding` – لجمع السجلات من عدة أجهزة
---
## 🧰 ثالثًا: **الخدمات (Services)**

#### 📌 ما هي الـ Services؟

برمجيات تعمل في الخلفية وتبدأ عادة مع إقلاع النظام.  
قد تكون جزءًا من النظام أو من برامج طرف ثالث.

📍 الوصول عبر:
> `services.msc`

#### 🎯 في المجال الأمني:
|الاستخدام|مثال|
|---|---|
|تشغيل Malware كخدمة|المهاجم يُثبت Backdoor كخدمة|
|التحكم عن بعد|خدمات مثل `Remote Desktop`, `Telnet`, `SSH`|
|اكتشاف Services غريبة|فحص الأسماء ومسارات التشغيل|
🛠️ أدوات:

- `sc query` – فحص الخدمات من سطر الأوامر

- `tasklist /svc` – العمليات المرتبطة بالخدمات

- `Process Hacker` – تحليل عميق
---
## 📂 رابعًا: ملفات النظام المهمة (System Files)
| الملف أو المسار                 | الدور                                                       |
| ------------------------------- | ----------------------------------------------------------- |
| `C:\Windows\System32`           | يحتوي على ملفات النظام الأساسية                             |
| `C:\Windows\System32\drivers`   | تعريفات الأجهزة – مراقبة ملفاته مهم جدًا                    |
| `C:\Windows\Prefetch`           | يحتفظ بملفات تُظهر ما تم تشغيله مؤخراً – مهم في Forensics   |
| `C:\Windows\Temp`               | ملفات مؤقتة – تُستخدم كثيرًا من قبل البرمجيات الخبيثة       |
| `Pagefile.sys` و `Hiberfil.sys` | تحتوي على محتوى من الذاكرة – يمكن استخراج بيانات حساسة منها |

---

## 🧠 خامسًا: سجل التصفح والآثار الرقمية

|النوع|المسار|
|---|---|
|**تاريخ المتصفح (Chrome)**|`C:\Users\USERNAME\AppData\Local\Google\Chrome\User Data\Default\History`|
|**كوكيز وجلسات**|موجودة في نفس المسار، في ملفات مختلفة|
|**Recent Files**|`C:\Users\USERNAME\Recent`|

🛠️ تحليل هذه الملفات مفيد جدًا في:

- التحقيقات الجنائية

- تتبع تصرفات مستخدم مشبوه

- تحديد كيف وصل التهديد للنظام
---
## 🧪 مثال تطبيقي:

**سيناريو**: تعرّض جهاز لاختراق وتم تنفيذ برنامج خبيث:

1. افتح `Event Viewer` وابحث عن توقيت تشغيل البرنامج.

2. راجع `HKLM\Run` لرؤية البرامج التي تعمل تلقائيًا.

3. افحص `Prefetch` لترى متى شُغل البرنامج وماذا شغّل بعده.

4. افحص `services.msc` إن كان أنشأ خدمة للبقاء.

5. راجع `Pagefile.sys` لاسترجاع بيانات حساسة تم تحميلها.

## 🧰 أدوات شاملة لفحص كل ما سبق:

|الأداة|الوظيفة|
|---|---|
|**Velociraptor**|أداة متقدمة لجمع الأدلة|
|**KAPE**|أداة مسح واستخراج آثار النظام|
|**FTK Imager**|استخراج الملفات والأدلة الرقمية|
|**RECmd**|تحليل الـ Registry بسطر الأوامر|

---
`Abdelwahab Shandy`

















