## 📜 **الباب الثامن: السجلات (Logs) وتحليلها في Windows**

> السجلات هي "ذاكرة النظام" — كل عملية، خطأ، دخول، أو محاولة اختراق تُسجّل هنا.  
> ومن خلال قراءتها بدقة، يمكننا معرفة: من دخل؟ ماذا فعل؟ متى؟ وما الذي تغيّر؟
---
## 📋 **أولًا: فتح Event Viewer**

> يمكنك فتحه عن طريق:
```
eventvwr.msc
```

أو:

1. Start Menu → Run → `eventvwr.msc`
    
2. أو عبر: Control Panel → Administrative Tools → Event Viewer
---
## 🗂️ **ثانيًا: أنواع السجلات في Event Viewer**

|نوع السجل|موقعه|وظيفته|
|---|---|---|
|**Security**|Windows Logs > Security|تسجيل الدخول، الخروج، فشل الدخول، الصلاحيات، التعديلات|
|**System**|Windows Logs > System|تعريفات الأجهزة، فشل في خدمات النظام، أخطاء التمهيد|
|**Application**|Windows Logs > Application|أخطاء البرامج المثبتة (مثل Office، Chrome...)|
|**Setup**|Windows Logs > Setup|تثبيتات النظام، تحديثات Windows، التهيئة|
|**Forwarded Events**|(اختياري)|في بيئات المؤسسات، تسجّل Logs من أجهزة أخرى|

---

## 🔐 **ثالثًا: سجل الأمان Security Log**

### 🎯 أهم Event IDs يجب معرفتها:

|Event ID|الوظيفة|ما تدل عليه|
|---|---|---|
|**4624**|تسجيل دخول ناجح|User Logon|
|**4625**|فشل تسجيل الدخول|Bad Password أو محاولة اختراق|
|**4648**|استخدام حساب لتسجيل دخول من خلال عملية|Login عبر برنامج|
|**4672**|تسجيل دخول بصلاحيات عالية|Elevated Admin Rights|
|**4720**|إنشاء مستخدم جديد|❗مريب في بعض الحالات|
|**4726**|حذف مستخدم||
|**4732**|إضافة مستخدم إلى مجموعة||
|**1102**|مسح سجل الأمان ❗||

> 📌 **مهم جدًا:** لو وجدت `1102` → معناها أن المهاجم حاول يخفي أثره.

---
## ⚙️ **رابعًا: سجل النظام System Log**

### تراقب منه:

- أعطال Services
- فشل الأجهزة
- أعطال تمهيد النظام (Boot)
- تغييرات في تعريفات الهاردوير
---
## 🧪 **خامسًا: كيف تقرأ السجل؟**

1. افتح Event Viewer

2. اختر نوع السجل (مثل Security)

3. من الجهة اليمنى → اختر “Filter Current Log”

4. ضع Event ID الذي تبحث عنه (مثل: `4625`)

5. اقرأ التفاصيل (Time – User – IP – Process name)

---
## 🧠 **سادسًا: سيناريو تحليلي بسيط**

> ❓ اكتشف هل تم تسجيل دخول مريب إلى الجهاز خلال آخر 24 ساعة

### ✅ الخطوات:

1. افتح PowerShell كمسؤول:
```
Get-EventLog -LogName Security -After (Get-Date).AddDays(-1) | Where-Object {$_.EventID -eq 4624} | Format-Table TimeGenerated, EntryType, Message -Wrap
```


2. راقب:

- متى تم الدخول؟
- من هو المستخدم؟
- من أي جهاز؟
- هل كانت الصلاحيات عالية (Admin)؟
---
## 🔐 **سابعًا: حفظ وتحليل السجلات خارج الجهاز**

- يمكنك **تصدير أي سجل**:
    
    1. افتح أي سجل
        
    2. اضغط: **Save All Events As...**
        
    3. احفظ كـ `.evtx` أو `.txt`
        
    4. افتحه لاحقًا للتحليل أو شاركه في تحقيق جنائي

---
## 📌 خلاصة Event Viewer:

|القسم|الاستخدام الأمني|
|---|---|
|**Security Log**|تعقب الدخول والخروج، مراقبة الأنشطة المشبوهة|
|**System Log**|اكتشاف مشاكل النظام أو تعاريف الأجهزة|
|**Application Log**|اكتشاف أخطاء في البرامج|
|**Setup Log**|مراجعة تثبيتات النظام والتحديثات|
