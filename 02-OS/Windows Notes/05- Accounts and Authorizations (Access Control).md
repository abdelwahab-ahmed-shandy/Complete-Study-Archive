#  🔐 Chapter Six: Accounts and Permissions (Access Control)

>من أهم الأبواب لفهم كيف يتم منح ومنع الصلاحيات للمستخدمين، وكيف يستغلها المهاجمون للوصول إلى الجهاز أو رفع صلاحياتهم (Privilege Escalation).

## 🔸 **أولاً: أنواع الحسابات في Windows**

|النوع|الوصف|الصلاحيات|
|---|---|---|
|**Administrator**|حساب مسؤول يتحكم بكل شيء|صلاحيات كاملة – يمكنه تعديل النظام، إدارة الحسابات، تشغيل أوامر حرجة|
|**Standard User**|حساب عادي|صلاحيات محدودة – لا يمكنه تثبيت برامج أو تعديل النظام|
|**Guest**|حساب مؤقت – معطل افتراضيًا|صلاحيات ضئيلة جدًا – يُستخدم أحيانًا في بيئات اختبار|

✅ **نصيحة أمنية**:  
لا تستخدم حساب Administrator إلا للضرورة – الأفضل أن تعمل كـ Standard User وتستخدم UAC عند الحاجة.

---
## 🧑‍💼 **ثانيًا: إدارة الحسابات من Local Users and Groups**

##### 📍 الوصول عبر:
```
lusrmgr.msc
```

🔒 _متاح فقط في إصدارات Pro / Enterprise – في Home استخدم PowerShell._

#### ✅ ما الذي يمكن فعله من هناك؟

|العنصر|الوظيفة|
|---|---|
|**Users**|عرض/تعديل/حذف المستخدمين|
|**Groups**|تحديد المجموعات وإضافة مستخدمين لها|
|**عضوية المجموعات**|المستخدم يرث الصلاحيات من مجموعته|

#### 📌 أهم المجموعات الافتراضية:

| المجموعة                 | صلاحياتها                                      |
| ------------------------ | ---------------------------------------------- |
| **Administrators**       | صلاحية التحكم الكامل بالنظام                   |
| **Users**                | مستخدمون عاديون                                |
| **Remote Desktop Users** | يُسمح لهم بالاتصال عبر RDP                     |
| **Guests**               | صلاحيات ضعيفة جدًا                             |
| **Power Users**          | صلاحيات متوسطة (قديمة ولا تُستخدم كثيرًا الآن) |

---
## 🛡️ **ثالثًا: UAC - User Account Control**

#### 📌 ما هو UAC؟

> نظام حماية يُظهر نافذة تنبيه عند محاولة تنفيذ مهمة إدارية (مثل تثبيت برنامج، تعديل النظام...)

#### 🎯 الهدف منه:

- يمنع البرامج الخبيثة من تنفيذ أوامر إدارية بدون إذن المستخدم.

- يمنع الـ Privilege Escalation التلقائي.

#### 🧪 مثال توضيحي:

إذا كنت مستخدم عادي، وحاولت تشغيل `cmd.exe` كمسؤول → يظهر تنبيه UAC.

#### ⚙️ يمكن التحكم في مستواه من:

```
Control Panel > User Accounts > Change UAC settings
```

| المستوى        | التأثير                   |
| -------------- | ------------------------- |
| Always Notify  | أقوى حماية – تنبيه دائمًا |
| Default        | تنبيه عند البرامج فقط     |
| Never Notify ❌ | خطير جدًا – لا ينصح به    |

---
## 🧠 **رابعًا: مفاهيم أساسية في التحكم بالصلاحيات (Access Control)**

|المصطلح|التعريف|
|---|---|
|**Access Token**|يُنشأ لكل مستخدم عند تسجيل الدخول – يحمل صلاحياته|
|**Security Identifier (SID)**|رقم معرف لكل مستخدم ومجموعة|
|**Access Control List (ACL)**|قائمة تحدد من له حق الوصول لكل ملف أو مجلد|
|**NTFS Permissions**|صلاحيات الملفات والمجلدات في نظام الملفات NTFS|

---
## 🧰 **خامسًا: أدوات فحص الصلاحيات والحسابات**

| الأداة                                         | الاستخدام                         |
| ---------------------------------------------- | --------------------------------- |
| `whoami`                                       | يعرض اسم المستخدم الحالي          |
| `whoami /groups`                               | المجموعات التي ينتمي لها المستخدم |
| `net user`                                     | عرض جميع الحسابات                 |
| `net localgroup administrators`                | من لديه صلاحيات مسؤول             |
| `Get-LocalUser` (PowerShell)                   | عرض الحسابات المحلية              |
| `Get-LocalGroupMember -Group "Administrators"` | معرفة من في مجموعة معينة          |

---
## 🧪 سيناريو أمني:

> ❓ **كيف تعرف هل هناك حساب مشبوه في الجهاز؟**

### ✅ الخطوات:

1. افتح PowerShell كمسؤول:

```
Get-LocalUser | Format-Table Name,Enabled,LastLogon
```

2. راجع:

- هل هناك حسابات جديدة؟

- هل يوجد حساب تم تفعيله مؤخرًا بعد أن كان معطلًا؟

- هل Guest مفعل؟ (يُستخدم كثيرًا من المهاجمين)


3. افحص الصلاحيات:
```
Get-LocalGroupMember -Group "Administrators"
```

- هل يوجد مستخدم غير مألوف في مجموعة المسؤولين؟

---

## 📌 نصائح أمنية:

- عطّل الحساب Guest إذا لم يكن مستخدمًا:
```
Disable-LocalUser -Name "Guest"
```

- لا تترك أكثر من حساب مسؤول نشط.

- راقب الحسابات التي لم تقم أنت بإنشائها.

- استخدم Event Viewer لفحص من قام بتسجيل الدخول (ID 4624).

---

## 🔚 خاتمة الباب:

الصلاحيات هي الخط الفاصل بين:

- مستخدم عادي لا يستطيع فعل شيء

- مهاجم يستطيع سرقة كل النظام


> ولذلك فإن فحص الحسابات، عضويات المجموعات، وضبط الـ UAC خطوة أساسية في حماية Windows.