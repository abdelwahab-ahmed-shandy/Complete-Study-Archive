
## 🧱 أولاً: ما هي الـ Access Control List (ACL)؟

هي مجموعة من القواعد تُستخدم للتحكم في مرور الترافيك داخل أو خارج جهاز الشبكة (مثل الراوتر أو السويتش).

- تُستخدم لتحديد من يُسمح له بالوصول ومن لا يُسمح له.
- يمكن تطبيقها على **الإنترفيس (interface)** أو **VTY lines**.

---
## 🧠 ثانياً: كيف تعمل ACL؟

1. الـ ACL تُفحص من الأعلى للأسفل، وتُطبّق أول شرط ينطبق.
2. إذا لم يتم تطابق أي شرط، يُطبّق **Implicit Deny All** (رفض ضمني في النهاية).
3. يمكن تطبيقها في اتجاهين:

    - `in`: لحركة المرور القادمة إلى الإنترفيس.
    - `out`: لحركة المرور الخارجة من الإنترفيس.

---
## 🧩 ثالثاً: أنواع الـ ACL

### 🔹 1. Standard ACL

- تتحكم في الترافيك بناءً فقط على **عنوان المصدر (Source IP)**
- تُكتب بالأرقام من **1 إلى 99** (أو من 1300 إلى 1999)

📌 مثال:

```
Router(config)# access-list 10 permit 192.168.1.0 0.0.0.255
Router(config)# interface fa0/0
Router(config-if)# ip access-group 10 in
```
🧠 هذا يعني أن أي حركة مرور من الشبكة `192.168.1.0/24` سيتم **السماح لها** بالدخول إلى هذا الإنترفيس.

---

### 🔸 2. Extended ACL

- تتحكم في الترافيك بناءً على:
    - IP المصدر
    - IP الوجهة
    - البروتوكول (TCP, UDP, ICMP)
    - البورت (مثل http, telnet, ftp...)
- تُكتب بالأرقام من **100 إلى 199** (أو من 2000 إلى 2699)

📌 مثال عملي:

```
Router(config)# access-list 110 deny tcp host 192.168.1.10 host 10.0.0.5 eq 80 

Router(config)# access-list 110 permit ip any any Router(config)# interface fa0/1 

Router(config-if)# ip access-group 110 out
```

🧠 هذا يمنع الجهاز 192.168.1.10 من فتح مواقع HTTP على الجهاز 10.0.0.5 فقط، ويسمح لباقي الترافيك.

---

## 🛠 رابعاً: أمثلة عملية لتطبيقات ACL

### ✅ مثال 1: منع جهاز معين من الوصول إلى شبكة

```
access-list 15 deny 192.168.10.5 access-list 15 permit any interface fa0/0 ip

access-group 15 in
```
### ✅ مثال 2: السماح لأجهزة VLAN معينة فقط باستخدام الـ TELNET
```
access-list 23 permit 192.168.10.0 0.0.0.255 line vty 0 4 access-class 23 in
```
---
## 🔐 خامساً: Access-Class (للـ VTY)

- تُستخدم للتحكم في من يُسمح له بالدخول عن طريق **Telnet/SSH**
- تُستخدم فقط مع **VTY lines**

📌 مثال:

```
access-list 55 permit 10.0.0.0 0.0.0.255 line vty 0 4 access-class 55 in
```

🧠 هذا يعني: فقط الأجهزة من الشبكة `10.0.0.0/24` يمكنها الدخول على الراوتر عبر Telnet أو SSH.

---
## 📎 سادساً: الفرق بين In و Out

- `in` → الترافيك الداخل إلى الإنترفيس.
- `out` → الترافيك الخارج من الإنترفيس.

مثال توضيحي:

- إذا كانت شبكة داخلية متصلة بـ Fa0/0 وتريد أن تتحكم في الترافيك **الذي يدخل الشبكة من الخارج**، فالتطبيق يكون `in` على Fa0/0.

---
## 🚫 سابعاً: مفهوم Implicit Deny

- كل ACL لها أمر "رفض ضمني" في النهاية.
```
deny ip any any  ←  موجود تلقائيًا (غير ظاهر)
```

🔺 لذلك من المهم دائمًا كتابة أمر `permit ip any any` في النهاية إذا كنت تريد السماح بالترافيك الآخر.

---
## 📘 ثامناً: جدول مختصر للتمييز

| النوع    | يتحكم في                                | رقم ACL             | الاستخدام    |
| -------- | --------------------------------------- | ------------------- | ------------ |
| Standard | IP المصدر فقط                           | 1–99 / 1300–1999    | فلترة بسيطة  |
| Extended | IP المصدر والوجهة + البروتوكول + البورت | 100–199 / 2000–2699 | فلترة متقدمة |

---
## 🎓 تاسعاً: ملاحظات مهمة

- 🧠 ACL لا تنفذ إلا على **الراوتر أو السويتش L3**.
- ✅ لا يمكن تطبيق أكثر من ACL واحدة على نفس الاتجاه في الإنترفيس.
- 🔄 دائمًا تأكد من وجود أمر `permit` لما تريد السماح به، أو سيُرفض الترافيك بسبب الـ Implicit Deny.


---
---
---
---


## ✅ أولًا: ACL - Standard

> تستخدم للتحكم في الترافيك بناءً على **IP المصدر فقط**

### 📌 الصيغة العامة:
```
access-list [رقم من 1 إلى 99] [permit | deny] [IP المصدر] [Wildcard mask]
```
### ✅ أمثلة:

|الهدف|الأمر|
|---|---|
|السماح لشبكة كاملة|`access-list 10 permit 192.168.10.0 0.0.0.255`|
|منع جهاز واحد|`access-list 10 deny 192.168.10.50`|
|السماح لأي مصدر|`access-list 10 permit any`|

### ✅ التطبيق:
```
interface [اسم الإنترفيس] ip access-group 10 in
```

---
## ✅ ثانيًا: ACL - Extended

> تتحكم في IP المصدر + IP الوجهة + البروتوكول + البورت
### 📌 الصيغة العامة:
```
access-list [100–199] [permit | deny] [protocol] [IP المصدر] [Wildcard] [IP الوجهة] [Wildcard] [port]
```

---
### ✅ بروتوكولات أساسية:

|البروتوكول|الاستخدام|
|---|---|
|tcp|يستخدم للـ HTTP/FTP/Telnet|
|udp|يستخدم لـ DNS|
|icmp|يستخدم لـ Ping|
|ip|لجميع الترافيك|

---
### ✅ أمثلة عملية:

|الهدف|الأمر|
|---|---|
|منع جهاز من فتح موقع HTTP|`access-list 110 deny tcp host 192.168.1.5 any eq 80`|
|منع شبكة من الوصول إلى سيرفر معين|`access-list 110 deny ip 192.168.10.0 0.0.0.255 host 10.0.0.5`|
|السماح ببقية الترافيك|`access-list 110 permit ip any any`|
|السماح بـ DNS فقط|`access-list 110 permit udp any any eq 53`|
|منع Ping بين شبكتين|`access-list 110 deny icmp 192.168.10.0 0.0.0.255 192.168.20.0 0.0.0.255`|

---
### ✅ التطبيق:
```
interface [اسم الإنترفيس] ip access-group 110 in | out
```

---
## ✅ ثالثًا: Access-Class (مع VTY Telnet/SSH)

> للتحكم في من يمكنه الدخول على الراوتر عبر VTY lines

### 📌 الصيغة:
```
access-list [رقم] permit [IP الشبكة] [Wildcard]  line vty 0 4 access-class [رقم ACL] in
```
### ✅ مثال:
```
access-list 25 permit 192.168.20.0 0.0.0.255 line vty 0 4 access-class 25 in
```

---
## ✅ رابعًا: Wildcard Mask المراجعة السريعة

| Subnet Mask     | Wildcard Mask  |
| --------------- | -------------- |
| 255.255.255.0   | 0.0.0.255      |
| 255.255.0.0     | 0.0.255.255    |
| 255.0.0.0       | 0.255.255.255  |
| 255.255.255.255 | 0.0.0.0 (host) |

---
## ✅ خامسًا: ملاحظات مهمة جدًا

- ❗ كل ACL لها **deny ip any any ضمني** في النهاية، لذا أضف `permit ip any any` إذا كنت لا تريد حظر كل شيء.
- ✅ ACL تُقرأ من الأعلى للأسفل.
- ❌ لا يمكن تطبيق أكثر من ACL واحدة لكل اتجاه على نفس الإنترفيس.
- 🔄 `in` تعني الترافيك الداخل إلى الإنترفيس، `out` يعني الخارج.

---
## 🧪 سادسًا: سيناريوهات سريعة للممارسة

|السيناريو|الأوامر المقترحة|
|---|---|
|منع الموظفين من HTTP فقط|`deny tcp 192.168.10.0 0.0.0.255 any eq 80` + `permit ip any any`|
|السماح فقط للمديرين باستخدام FTP|`permit tcp 192.168.20.0 0.0.0.255 host 10.0.0.100 eq 21` + `deny ip any any`|
|منع Attacker من DNS|`deny udp host 192.168.10.200 any eq 53` + `permit ip any any`|
|Telnet للمديرين فقط|`access-list 50 permit 192.168.20.0 0.0.0.255` + `access-class 50 in`|

---
---
`Abdelwahab Shandy "))`
