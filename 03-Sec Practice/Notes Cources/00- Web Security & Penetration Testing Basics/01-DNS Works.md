# 🌐 **شرح مفصل لكيفية عمل DNS (نظام أسماء النطاقات)**
---
## 🌐 أولًا: ما هو DNS؟ ولماذا تم اختراعه؟

### 💡 **التعريف:**

- DNS = **Domain Name System** → نظام أسماء النطاقات.
    
- ببساطة، هو النظام اللي بيخلينا نكتب `google.com` بدل ما نكتب IP مثل `142.250.184.14`.

#### 🧠 **لماذا نحتاج DNS؟**

قبل الـ DNS، عشان تفتح موقع لازم تكتب عنوانه الرقمي (IP).  
مثلاً:

- تكتب `216.58.212.14` عشان تفتح جوجل.  
    لكن طبعًا من الصعب تفتكر IP لكل موقع.

فـ **DNS جاء كحل**:

- يخليك تكتب اسم مفهوم (مثل google.com).
    
- وهو يتولى ترجمة الاسم لـ IP.
---
## 🧭 ثانيًا: كيف يعمل DNS خطوة بخطوة؟ (رحلة الـ DNS Query)

تخيل إنك عايز تفتح `www.yahoo.com`.  
العملية بتمشي في 7 مراحل، كلها تحدث في **أجزاء من الثانية**:

---
### ⚙️ **الخطوة 1: المستخدم يطلب موقع**

- تكتب الدومين في المتصفح → `www.yahoo.com`
    
- المتصفح بيبعث طلب DNS علشان يعرف الـ IP.

---
### ⚙️ **الخطوة 2: فحص الكاش (DNS Cache)**

- الجهاز يشوف: هل الـ IP لهذا الدومين موجود في ذاكرته المؤقتة؟
    
    - ✅ موجود؟ يتم استخدامه فورًا بدون أي استعلام خارجي.
        
    - ❌ غير موجود؟ نبدأ رحلة الاستعلام...

---
### ⚙️ **الخطوة 3: الاتصال بـ DNS Resolver**

- الـ **Resolver** هو السيرفر المحلي (عادة من شركة الإنترنت زي We أو Vodafone).
    
- دوره زي “موظف الاستعلامات”.
    
- لو ما عندوش المعلومة، يبدأ هو كمان يسأل.

---
### ⚙️ **الخطوة 4: سؤال Root Name Server**

- فيه 13 Root Server حول العالم (A–M Root Servers).
    
- مسؤولين عن معرفة:
> “من هو السيرفر المسؤول عن امتداد `.com`؟”
    
- لا يعطون الـ IP النهائي، بل يحيلون للخطوة التالية...

|الحرف|اسم السيرفر الكامل|المُشغل|
|---|---|---|
|A|`a.root-servers.net`|VeriSign (أمريكا)|
|B|`b.root-servers.net`|USC-ISI (أمريكا)|
|C|`c.root-servers.net`|Cogent Communications|
|D|`d.root-servers.net`|University of Maryland|
|E|`e.root-servers.net`|NASA Ames Research Center|
|F|`f.root-servers.net`|Internet Systems Consortium (ISC)|
|G|`g.root-servers.net`|U.S. Department of Defense (NIC)|
|H|`h.root-servers.net`|U.S. Army Research Lab|
|I|`i.root-servers.net`|Netnod (السويد)|
|J|`j.root-servers.net`|VeriSign (أمريكا)|
|K|`k.root-servers.net`|RIPE NCC (أوروبا)|
|L|`l.root-servers.net`|ICANN|
|M|`m.root-servers.net`|WIDE Project (اليابان)|
#### 🌍 هل هم موجودين فقط في 13 مكان؟

لا! كل سيرفر من دول عنده **عشرات النسخ الموزعة جغرافيًا** حول العالم (في إفريقيا، آسيا، أمريكا، أوروبا…) والفضل يرجع لتقنية اسمها:

##### ➤ **Anycast**

- بتسمح بإنشاء **نسخ متعددة** من نفس السيرفر.
    
- المستخدم يُوجه تلقائيًا لأقرب نسخة جغرافيًا.
    
- هذا يضمن:
    
    - سرعة أكبر.
        
    - تقليل الحمل على كل خادم.
        
    - مقاومة للهجمات (خاصة DDoS).

---
### ⚙️ **الخطوة 5: سؤال TLD Name Server**

- ده السيرفر المسؤول عن امتداد النطاق، زي `.com` أو `.net`.
    
- يقول:
> "عندك الدومين `yahoo.com`؟ روح اسأل السيرفر المسؤول عن yahoo."

---
### ⚙️ **الخطوة 6: سؤال Authoritative Name Server**

- هذا هو السيرفر الفعلي الذي يحتوي على:
    
    > "ما هو عنوان IP الخاص بـ `www.yahoo.com`؟"
    
- يرد بـ:
    
    - **A Record**: العنوان الرقمي (مثلاً: `98.137.11.163`)

---
### ⚙️ **الخطوة 7: العودة بالـ IP**

- الـ Resolver يأخذ الـ IP ويرجعه لجهازك.
    
- الجهاز يفتح الموقع.
    
- وفي نفس الوقت، **يخزن الـ IP في الكاش** لتسريع الطلب في المرات القادمة.

---
## 🗃️ ثالثًا: ما هي Zone Files وما أنواع DNS Records؟

#### 📁 **Zone File:**

- ملف داخل الـ Authoritative Server يحتوي على معلومات الدومين.

### 📜 **أنواع سجلات DNS الأساسية:**

|النوع|الوظيفة|مثال|
|---|---|---|
|A Record|يربط اسم الدومين بـ IPv4|`google.com → 142.250.184.14`|
|AAAA|يربط بـ IPv6|`example.com → 2001:db8::1`|
|MX|يُحدد سيرفرات البريد الإلكتروني|`yahoo.com → mx1.mail.yahoo.com`|
|CNAME|اسم مستعار (Alias)|`mail.example.com → example.com`|
|NS|يُحدد السيرفرات المسؤولة عن النطاق|`NS1.dns-provider.com`|
|TXT|معلومات نصية مثل SPF/DKIM|تستخدم في تأكيد ملكية أو حماية البريد|
|SOA|بيانات إدارية عن النطاق|مثل توقيت التحديث واسم المسؤول|

---

## 🛠️ رابعًا: أدوات معرفة بيانات DNS لأي دومين

### ✅ أداة `dig` (في لينكس وكالي):

#### 📌 للحصول على كل معلومات الدومين:

```
dig yahoo.com any
```
#### 📌 للحصول على سجل معين (مثلاً MX فقط):

```
dig yahoo.com MX
```
#### 📌 مع تفاصيل أكثر:

```
dig +trace yahoo.com
```

---
### ✅ أداة `nslookup` (في ويندوز):

```
nslookup yahoo.com
```

---

### 🌐 مواقع خارجية مجانية:

#### 🔍 [MXToolbox](https://mxtoolbox.com)

- أدخل اسم الدومين.
    
- اختر نوع السجل (MX, A, TXT…).

#### 🔍 [Who.is](https://who.is)

- للحصول على:
    
    - اسم الشركة المالكة للنطاق.
        
    - تاريخ الحجز والانتهاء.
        
    - بيانات الاتصال إن لم تكن مخفية.

|نوع المعلومة|الوصف|
|---|---|
|**Registrant**|اسم الشركة أو الشخص المسجل|
|**Registrar**|الشركة التي تم تسجيل النطاق من خلالها|
|**Creation Date**|تاريخ تسجيل النطاق|
|**Expiration Date**|تاريخ انتهاء الدومين|
|**Updated Date**|آخر مرة تم فيها تعديل البيانات|
|**DNS Servers**|السيرفرات التي تخدم هذا الدومين|

---

## 🎯 **الخلاصة – رحلة استعلام DNS باختصار**

1. المتصفح يطلب `example.com`.
    
2. الجهاز يبحث في الكاش.
    
3. يطلب من DNS Resolver.
    
4. Resolver يسأل Root Server.
    
5. يحصل على عنوان TLD Server.
    
6. يسأل TLD Server → يحصل على عنوان Authoritative Server.
    
7. Authoritative Server يعطي الـ IP.
    
8. الموقع يُفتح، والـ IP يُخزن مؤقتًا.
---
## ✅ **الملخص النهائي**

|الجزء|التفاصيل|
|---|---|
|ما هو DNS؟|نظام لتحويل أسماء المواقع إلى IP|
|لماذا نحتاجه؟|تسهيل الوصول إلى المواقع بدون حفظ الأرقام|
|خطوات الاستعلام|Resolver → Root → TLD → Authoritative Server|
|أنواع السجلات|A – AAAA – MX – CNAME – TXT – SOA – NS|
|أدوات الفحص|dig – MXToolbox – who.is|
